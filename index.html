<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Home Credit Cash Loan - Version 1 (Revised)</title>
  <style>
    /* --- Basic Reset & Font --- */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Aptos', sans-serif; margin: 0; padding: 0; color: #333; }
    a { text-decoration: none; color: red; cursor: pointer; }

    /* --- Utility & Layout --- */
    .container { width: 100%; max-width: 1200px; margin: 0 auto; padding: 20px; }
    .screen { display: none; }
    .active { display: block; }
    .header { display: flex; align-items: center; gap: 10px; margin-bottom: 30px; }
    .header .brand { color: red; font-weight: bold; font-size: 20px; }
    .footer-subtext { 
      font-size: 12px;
      font-style: italic;
      text-align: center;
      margin-top: 20px;
    }

    /* --- Buttons & Inputs --- */
    .cta { background-color: red; color: white; border: none; padding: 12px 20px; cursor: pointer; font-size: 16px; border-radius: 4px; }
    .cta:hover { background-color: #c90000; }
    .grey-btn { background-color: #ccc; color: #333; font-style: italic; border: none; padding: 8px 16px; cursor: pointer; font-size: 14px; border-radius: 4px; }
    .adjust-btn { background-color: white; color: black; border: 1px solid black; padding: 10px 18px; cursor: pointer; font-size: 14px; border-radius: 4px; }
    .adjust-btn:hover { background-color: #f2f2f2; }
    input[type="range"] { width: 100%; }
    label { display: block; margin-bottom: 5px; font-weight: 500; }
    .checkbox-label { display: flex; align-items: center; gap: 5px; margin-bottom: 10px; }

    /* --- Screen 1: Landing Page --- */
    #screen1 { text-align: center; padding-top: 40px; }
    #screen1 h1 { font-size: 48px; margin-bottom: 10px; }
    #screen1 .subtext { font-size: 16px; font-style: italic; margin-bottom: 20px; }

    /* --- Screen 2: Loan Calculator --- */
    #screen2 .title { font-size: 24px; margin-bottom: 20px; }
    .calculator-container { display: flex; flex-wrap: wrap; gap: 20px; }
    .summary-box { flex: 1; border: 1px solid #ccc; border-radius: 4px; padding: 20px; min-width: 250px; max-width: 350px; }
    .summary-box h3 { margin-bottom: 15px; font-size: 18px; }
    .summary-box p { margin-bottom: 10px; }
    .calc-controls { flex: 2; border: 1px solid #ccc; border-radius: 4px; padding: 20px; min-width: 300px; }
    .slider-row { margin-bottom: 20px; }
    .slider-row label { display: block; margin-bottom: 5px; }
    .terms-row { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px; }
    .term-box { padding: 10px 15px; border: 1px solid #ccc; border-radius: 4px; cursor: pointer; user-select: none; }
    .term-box.selected { border-color: red; font-weight: bold; }
    .addons-row { margin-bottom: 20px; }
    .addons-row label { font-weight: normal; }
    .monthly-result { margin-top: 20px; font-size: 18px; font-weight: bold; }

    /* --- Screen 3: Offer Cards --- */
    #screen3 h2 { margin-bottom: 20px; }
    .offers-flex { display: flex; gap: 20px; margin-bottom: 30px; flex-wrap: wrap; }
    .offer-card { flex: 1; border: 2px solid #ccc; border-radius: 4px; padding: 20px; position: relative; min-width: 280px; cursor: pointer; }
    .offer-card.selected { border-color: red; }
    .offer-card .checkmark { display: none; position: absolute; top: 10px; right: 10px; background-color: red; color: white; width: 20px; height: 20px; border-radius: 50%; text-align: center; line-height: 20px; font-size: 14px; font-weight: bold; }
    .offer-card.selected .checkmark { display: block; }
    .offer-card h3 { margin-bottom: 15px; }
    .offer-price { margin-bottom: 10px; }
    .offer-price .strike { text-decoration: line-through; color: #999; }
    .inclusions-title { font-weight: bold; margin-top: 15px; }
    .inclusions-list { margin-top: 10px; }
    .inclusions-list li { margin-bottom: 5px; list-style-type: none; }
    .countdown { margin-top: 20px; font-size: 14px; font-weight: bold; }
    .offer-actions { text-align: center; }
    .offer-actions .secondary-actions { font-size: 12px; margin-top: 10px; }

    /* --- Screen 4_3: Adjust Offer --- */
    #screen4_3 { }

    /* --- Screen 5: Final Form Screen --- */
    .form-screen .form-container { display: flex; flex-wrap: wrap; gap: 20px; }
    .form-screen .summary-box { flex: 1; min-width: 250px; max-width: 350px; border: 1px solid #ccc; border-radius: 4px; padding: 20px; }
    .form-screen .form-box { flex: 2; min-width: 300px; border: 1px solid #ccc; border-radius: 4px; padding: 20px; }
    .subsubtext { font-size: 12px; font-style: italic; margin-top: 10px; }

    /* --- Modal --- */
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    .modal-content {
      background: #fff;
      padding: 20px;
      max-width: 400px;
      text-align: center;
      border-radius: 4px;
    }
    .modal-buttons { margin-top: 20px; }
    .modal-buttons button { margin: 5px; }
  </style>
</head>
<body>

  <!-- Screen 1: Landing Page -->
  <div id="screen1" class="screen active">
    <div class="container">
      <div class="header">
        <span class="brand">Home Credit</span>
      </div>
      <h1>You are eligible for a cash loan</h1>
      <div class="subtext">(This is exclusive to Home Credit employees only, please do not distribute externally.)</div>
      <div style="margin-top:30px;">
        <button class="cta" onclick="goToScreen('screen2')">Compute Offer →</button>
      </div>
    </div>
  </div>

  <!-- Screen 2: Loan Calculator (unchanged) -->
  <div id="screen2" class="screen">
    <div class="container">
      <div class="header">
        <span class="brand">Home Credit</span>
      </div>
      <div class="title">Get a sample cash loan computation</div>
      <div class="calculator-container">
        <div class="summary-box">
          <h3>Loan Summary</h3>
          <p>Loan Term: <span id="summaryTerm">24</span> months</p>
          <p>Loan Amount: Php <span id="summaryAmount">50,000</span></p>
          <p>Processing Fee: Php 500</p>
          <p>Amount to be Disbursed: Php <span id="summaryDisbursed">49,500</span></p>
          <p class="monthly-result">Est. Monthly: Php <span id="summaryMonthly">0.00</span></p>
        </div>
        <div class="calc-controls">
          <div class="slider-row">
            <p><strong>Selected Amount:</strong> ₱<span id="loanAmountDisplay">50,000</span></p>
            <label>How much money do you need?</label>
            <input type="range" id="loanAmount" min="10000" max="150000" step="1000" value="50000" oninput="updateCalculator()">
          </div>
          <div>
            <label>Sample Loan Terms (months):</label>
            <div class="terms-row" id="termOptions"></div>
          </div>
          <div class="addons-row">
            <label><strong>Add-ons</strong></label>
            <div class="checkbox-label">
              <input type="checkbox" id="borrowerProtection" checked onchange="updateCalculator()">
              <span>Borrower's Protection</span>
            </div>
            <div class="checkbox-label">
              <input type="checkbox" id="extraCare" checked onchange="updateCalculator()">
              <span>Extra Care</span>
            </div>
          </div>
          <div class="monthly-result">
            Estimated Monthly Installment: ₱<span id="monthlyInstallment">0.00</span>
          </div>
          <div style="margin-top:20px;">
            <button class="cta" onclick="saveCalculatorSelections(); goToScreen('screen3')">Continue</button>
          </div>
          <div style="margin-top:10px;">
            <button onclick="goToScreen('screen1')">Back</button>
          </div>
        </div>
      </div>
      <div class="footer-subtext">(This is exclusive to Home Credit employees only, please do not distribute externally.)</div>
    </div>
  </div>

  <!-- Screen 3: Offer Cards (unchanged, with Back button removed) -->
  <div id="screen3" class="screen">
    <div class="container">
      <div class="header">
        <span class="brand">Home Credit</span>
      </div>
      <h2>Select Your Offer</h2>
      <div class="offers-flex">
        <div id="limitedOffer" class="offer-card" onclick="selectOffer('limited')">
          <div class="checkmark">✓</div>
          <h3>Limited Time Offer</h3>
          <div style="font-size:14px; font-style:italic; margin-bottom:10px;">Cash Loan with VAS Bundle&nbsp;</div>
          <p>Loan Amount: <span id="limitedLoanAmount"></span></p>
          <p>Loan Term: <span id="limitedLoanTerm"></span> months</p>
          <p class="offer-price">
            Standard Monthly Installment: <span class="strike" id="limitedStriked">0.00</span><br>
            Discounted Monthly Installment: <strong id="limitedSpecial">0.00</strong> (<span id="priceDiff">less 0.00</span>)
          </p>
          <div class="inclusions-title">Inclusions:</div>
          <ul class="inclusions-list" id="limitedInclusions"></ul>
          <div class="countdown">Limited time offer expires in: <span id="timer"></span></div>
        </div>
        <div id="basicOffer" class="offer-card" onclick="selectOffer('basic')">
          <div class="checkmark">✓</div>
          <h3>Basic Offer</h3>
          <p>Loan Amount: <span id="basicLoanAmount"></span></p>
          <p>Loan Term: <span id="basicLoanTerm"></span> months</p>
          <p>Monthly Installment: <strong id="basicInstallment">0.00</strong></p>
          <div class="inclusions-title">Inclusions:</div>
          <ul class="inclusions-list" id="basicInclusions"></ul>
        </div>
      </div>
      <div class="offer-actions">
        <button class="cta" onclick="confirmOffer(userSelections.offerSelected)">Select This Offer</button>
        <div class="secondary-actions" style="font-size:12px; margin-top:10px;">
          <button class="adjust-btn" onclick="showAdjustModal()">Adjust Offer</button>
          <button class="grey-btn" onclick="showNotInterestedModal()">I am not interested</button>
        </div>
      </div>
      <div class="footer-subtext">(This is exclusive to Home Credit employees only, please do not distribute externally.)</div>
    </div>
  </div>

  <!-- Modal for Pop-ups (unchanged) -->
  <div id="confirmationModal" class="modal">
    <div class="modal-content">
      <h3 id="modalTitle">Are you sure?</h3>
      <p id="modalMessage"></p>
      <div class="modal-buttons">
        <button class="cta" id="modalPrimaryBtn"></button>
        <button id="modalSecondaryBtn"></button>
      </div>
    </div>
  </div>

  <!-- Modal for "No Adjustments Made" (unchanged) -->
  <div id="noAdjustmentsModal" class="modal">
    <div class="modal-content">
      <h3>Looks like you did not make any adjustments</h3>
      <p>Go back to offer cards instead?</p>
      <div class="modal-buttons">
        <button class="cta" onclick="closeNoAdjustmentsModal(); goToScreen('screen3')">Back</button>
      </div>
    </div>
  </div>

  <!-- Screen 4_3: Adjust Offer (unchanged) -->
  <div id="screen4_3" class="screen">
    <div class="container">
      <div class="header">
        <span class="brand">Home Credit</span>
      </div>
      <h2>Adjust Your Offer</h2>
      <div class="calculator-container">
        <div class="summary-box">
          <h3>Loan Summary</h3>
          <p>Loan Term: <span id="summaryTermAdjust">24</span> months</p>
          <p>Loan Amount: Php <span id="summaryAmountAdjust">50,000</span></p>
          <p>Processing Fee: Php 500</p>
          <p>Amount to be Disbursed: Php <span id="summaryDisbursedAdjust">49,500</span></p>
          <p class="monthly-result">Est. Monthly: Php <span id="monthlyInstallmentAdjust">0.00</span></p>
        </div>
        <div class="calc-controls">
          <div class="slider-row">
            <p><strong>Selected Amount:</strong> ₱<span id="loanAmountAdjustDisplay">50000</span></p>
            <label>How much money do you need?</label>
            <input type="range" id="loanAmountAdjust" min="10000" max="150000" step="1000" value="50000" oninput="updateCalculatorAdjust()">
          </div>
          <div>
            <label>Loan Terms (months):</label>
            <div class="terms-row" id="termOptionsAdjust"></div>
          </div>
          <div class="addons-row">
            <label><strong>Add-ons</strong></label>
            <div class="checkbox-label">
              <input type="checkbox" id="borrowerProtectionAdjust" checked onchange="updateCalculatorAdjust()">
              <span>Borrower's Protection</span>
            </div>
            <div class="checkbox-label">
              <input type="checkbox" id="extraCareAdjust" checked onchange="updateCalculatorAdjust()">
              <span>Extra Care</span>
            </div>
          </div>
          <div style="text-align:center; margin-top:20px;">
            <button class="cta" onclick="submitAdjust()">Continue</button>
          </div>
          <div style="margin-top:10px;">
            <button onclick="goToScreen('screen3')">Back</button>
          </div>
        </div>
      </div>
      <div class="footer-subtext">(This is exclusive to Home Credit employees only, please do not distribute externally.)</div>
    </div>
  </div>

  <!-- Screen 5: Final Form Screen (with additional sub-subtext) -->
  <div id="screen5" class="screen form-screen">
    <div class="container">
      <div class="header">
        <span class="brand">Home Credit</span>
      </div>
      <div class="form-container">
        <div class="summary-box">
          <h3>Loan Summary</h3>
          <p>Loan Amount: Php <span id="summaryAmount5"></span></p>
          <p>Term: <span id="summaryTerm5"></span> months</p>
          <p>Monthly Installment: Php <span id="summaryMonthly5"></span></p>
        </div>
        <div class="form-box">
          <h4>Thank you for expressing interest in Home Credit Cash Loan!</h4>
          <p>Please fill out the form below so we can get in touch with you once the offer is available. Note that this form does not guarantee that you will receive a real offer.</p>
          <p class="subsubtext">
            <em>If the form did not launch, please click the "Fill out this form" button below.</em>
          </p>
          <iframe
            width="640px"
            height="480px"
            src="https://forms.office.com/Pages/ResponsePage.aspx?id=28KJynnWnUiJ-ySGzZre1EloKcko8s1Nm-G00mjtE4tUNTJXN0s3NTEzSkU0Vk81NEozSVJNRjE5TC4u&embed=true"
            frameborder="0"
            marginwidth="0"
            marginheight="0"
            style="border: none; max-width:100%; max-height:100vh"
            allowfullscreen
            webkitallowfullscreen
            mozallowfullscreen
            msallowfullscreen>
          </iframe>
          <div style="margin-top:20px;">
            <button class="cta" onclick="backFromScreen5()">Back</button>
          </div>
        </div>
      </div>
      <div class="footer-subtext">(This is exclusive to Home Credit employees only, please do not distribute externally.)</div>
    </div>
  </div>

  <!-- JavaScript Logic -->
  <script>
    var userSelections = {
      loanAmount: 50000,
      loanTerm: 24,
      borrowerProtection: true,
      extraCare: true,
      offerSelected: 'limited', // 'limited', 'basic', or 'adjust'
      adjust: {},
      notInterested: false,
      cameFromAdjust: false
    };

    var availableTerms = [6, 9, 12, 18, 24, 30, 36, 42, 48];
    var limitedOfferExpiry;
    var countdownInterval;

    function goToScreen(screen) {
      var screens = document.getElementsByClassName('screen');
      for (var i = 0; i < screens.length; i++) {
        screens[i].classList.remove('active');
      }
      var targetId = screen.startsWith("screen") ? screen : "screen" + screen;
      document.getElementById(targetId).classList.add('active');

      if(targetId === "screen3") {
        userSelections.cameFromAdjust = false;
        updateOfferCards();
      }
      if(targetId === "screen4_3") {
        userSelections.cameFromAdjust = true;
        createTermBoxes('termOptionsAdjust', true);
        updateCalculatorAdjust();
        userSelections.adjust.initialAmount = userSelections.adjust.loanAmount || userSelections.loanAmount;
        userSelections.adjust.initialTerm = userSelections.adjust.loanTerm || userSelections.loanTerm;
        userSelections.adjust.initialBP = (userSelections.adjust.borrowerProtection !== undefined)
          ? userSelections.adjust.borrowerProtection
          : userSelections.borrowerProtection;
        userSelections.adjust.initialEC = (userSelections.adjust.extraCare !== undefined)
          ? userSelections.adjust.extraCare
          : userSelections.extraCare;
      }
      if(targetId === "screen5") {
        updateFormSummary();
      }
    }

    function backFromScreen5() {
      if(userSelections.cameFromAdjust) { 
        goToScreen('screen4_3'); 
      } else { 
        goToScreen('screen3'); 
      }
    }

    window.onload = function() {
      createTermBoxes('termOptions', false);
      updateCalculator();
    };

    function createTermBoxes(containerId, isAdjust) {
      var container = document.getElementById(containerId);
      container.innerHTML = '';
      availableTerms.forEach(function(t) {
        var box = document.createElement('div');
        box.classList.add('term-box');
        box.innerText = t;
        box.onclick = function() {
          if(isAdjust) {
            userSelections.adjust.loanTerm = t;
            updateCalculatorAdjust();
          } else {
            userSelections.loanTerm = t;
            updateCalculator();
          }
        };
        container.appendChild(box);
      });
    }

    function highlightSelectedTerm(containerId, selectedTerm) {
      var container = document.getElementById(containerId);
      var boxes = container.getElementsByClassName('term-box');
      for(var i = 0; i < boxes.length; i++){
        var tVal = parseInt(boxes[i].innerText);
        if(tVal === selectedTerm) { boxes[i].classList.add('selected'); }
        else { boxes[i].classList.remove('selected'); }
      }
    }

    /* Screen2 Calculator */
    function updateCalculator() {
      var amount = parseInt(document.getElementById('loanAmount').value);
      userSelections.loanAmount = amount;
      document.getElementById('loanAmountDisplay').innerText = formatNumber(amount);
      var term = userSelections.loanTerm;
      highlightSelectedTerm('termOptions', term);
      userSelections.borrowerProtection = document.getElementById('borrowerProtection').checked;
      userSelections.extraCare = document.getElementById('extraCare').checked;
      var monthly = computeMonthlyInstallment(amount, term, 0.06, userSelections.borrowerProtection, userSelections.extraCare);
      document.getElementById('monthlyInstallment').innerText = formatNumber(monthly.toFixed(2));
      document.getElementById('summaryTerm').innerText = term;
      document.getElementById('summaryAmount').innerText = formatNumber(amount);
      document.getElementById('summaryDisbursed').innerText = formatNumber(amount - 500);
      document.getElementById('summaryMonthly').innerText = formatNumber(monthly.toFixed(2));
    }
    function saveCalculatorSelections() { updateCalculator(); }

    /* Screen4_3: Adjust Offer Calculator */
    function updateCalculatorAdjust() {
      var amount = parseInt(document.getElementById('loanAmountAdjust').value);
      userSelections.adjust.loanAmount = amount;
      document.getElementById('loanAmountAdjustDisplay').innerText = formatNumber(amount);
      var term = userSelections.adjust.loanTerm || 24;
      highlightSelectedTerm('termOptionsAdjust', term);
      userSelections.adjust.borrowerProtection = document.getElementById('borrowerProtectionAdjust').checked;
      userSelections.adjust.extraCare = document.getElementById('extraCareAdjust').checked;
      var monthly = computeMonthlyInstallment(amount, term, 0.06, userSelections.adjust.borrowerProtection, userSelections.adjust.extraCare);
      document.getElementById('monthlyInstallmentAdjust').innerText = formatNumber(monthly.toFixed(2));
      document.getElementById('summaryTermAdjust').innerText = term;
      document.getElementById('summaryAmountAdjust').innerText = formatNumber(amount);
      document.getElementById('summaryDisbursedAdjust').innerText = formatNumber(amount - 500);
    }

    function submitAdjust() {
      updateCalculatorAdjust();
      var madeChange = false;
      var initAmt = userSelections.adjust.initialAmount;
      var initTerm = userSelections.adjust.initialTerm;
      var initBP = userSelections.adjust.initialBP;
      var initEC = userSelections.adjust.initialEC;
      var newAmt = userSelections.adjust.loanAmount || userSelections.loanAmount;
      var newTerm = userSelections.adjust.loanTerm || userSelections.loanTerm;
      var newBP = userSelections.adjust.borrowerProtection;
      var newEC = userSelections.adjust.extraCare;
      if(newAmt != initAmt || newTerm != initTerm || newBP != initBP || newEC != initEC) { madeChange = true; }
      if(!madeChange) {
        document.getElementById('noAdjustmentsModal').style.display = 'flex';
      } else {
        userSelections.offerSelected = 'adjust';
        userSelections.notInterested = false;
        userSelections.cameFromAdjust = true;
        goToScreen('screen5');
      }
    }
    function closeNoAdjustmentsModal() {
      document.getElementById('noAdjustmentsModal').style.display = 'none';
    }

    /* Amortization Calculation */
    function computeMonthlyInstallment(amount, term, rate, includeBP, includeEC) {
      var principal = amount - 500;
      var r = rate;
      var base = (principal * r * Math.pow(1 + r, term)) / (Math.pow(1 + r, term) - 1);
      var bpCost = 0;
      if(includeBP) { bpCost = (amount <= 25000) ? (0.004 * amount + 50) : (0.003 * amount + 50); }
      var ecCost = includeEC ? 99 : 0;
      return base + bpCost + ecCost;
    }

    /* Screen3: Offer Cards */
    function updateOfferCards() {
      var amount = userSelections.loanAmount;
      var term = userSelections.loanTerm;
      var standard = computeMonthlyInstallment(amount, term, 0.065, true, true);
      var discounted = computeMonthlyInstallment(amount, term, 0.05, true, true);
      var diff = (standard - discounted).toFixed(2);
      document.getElementById('limitedLoanAmount').innerText = formatNumber(amount);
      document.getElementById('limitedLoanTerm').innerText = term;
      document.getElementById('limitedStriked').innerText = formatNumber(standard.toFixed(2));
      document.getElementById('limitedSpecial').innerText = formatNumber(discounted.toFixed(2));
      document.getElementById('priceDiff').innerText = "less " + formatNumber(diff);
      var limitedUl = document.getElementById('limitedInclusions');
      limitedUl.innerHTML = '';
      var incs = [
        'FREE Full/Partial Early Repayment',
        '2x Payment Holiday',
        '2x Due Date Change',
        '120% of Loan Amount Insurance Coverage',
        'Unlimited Online Medical Consultation'
      ];
      incs.forEach(function(item) {
        var li = document.createElement('li');
        li.innerHTML = `<span style="color:green;font-weight:bold;">✓</span> ${item}`;
        limitedUl.appendChild(li);
      });
      var basic = computeMonthlyInstallment(amount, term, 0.065, userSelections.borrowerProtection, userSelections.extraCare);
      document.getElementById('basicLoanAmount').innerText = formatNumber(amount);
      document.getElementById('basicLoanTerm').innerText = term;
      document.getElementById('basicInstallment').innerText = formatNumber(basic.toFixed(2));
      var basicUl = document.getElementById('basicInclusions');
      basicUl.innerHTML = '';
      var lines = [];
      if(userSelections.borrowerProtection && userSelections.extraCare) {
        lines = [
          '✓ FREE Full/Partial Early Repayment',
          '✓ 2x Payment Holiday',
          '✓ 2x Due Date Change',
          '✓ 120% of Loan Amount Insurance Coverage',
          '✓ Unlimited Online Medical Consultation'
        ];
      } else if(userSelections.borrowerProtection && !userSelections.extraCare) {
        lines = [
          '× P300 fee for Full/Partial Early Repayment',
          '× P300 fee for Due Date Change',
          '× NO Payment Holiday option',
          '✓ 120% of Loan Amount Insurance Coverage',
          '✓ Unlimited Online Medical Consultation'
        ];
      } else if(!userSelections.borrowerProtection && userSelections.extraCare) {
        lines = [
          '✓ FREE Full/Partial Early Repayment',
          '✓ 2x Payment Holiday',
          '✓ 2x Due Date Change',
          '× NO Insurance Coverage',
          '× NO Online Medical Consultation'
        ];
      } else {
        lines = [
          '× P300 fee for Full/Partial Early Repayment',
          '× P300 fee for Due Date Change',
          '× NO Payment Holiday option',
          '× NO Insurance Coverage',
          '× NO Online Medical Consultation'
        ];
      }
      lines.forEach(function(l) {
        var li = document.createElement('li');
        if(l.startsWith('✓')) {
          li.innerHTML = `<span style="color:green;font-weight:bold;">✓</span> ${l.substring(1).trim()}`;
        } else if(l.startsWith('×')) {
          li.innerHTML = `<span style="color:red;font-weight:bold;">×</span> ${l.substring(1).trim()}`;
        } else { li.innerHTML = l; }
        basicUl.appendChild(li);
      });
      selectOffer('limited');
      var now = new Date();
      limitedOfferExpiry = new Date(now.getTime() + 5 * 24 * 60 * 60 * 1000);
      startCountdown();
    }

    function selectOffer(type) {
      userSelections.offerSelected = type;
      if(type === 'limited') {
        document.getElementById('limitedOffer').classList.add('selected');
        document.getElementById('basicOffer').classList.remove('selected');
      } else {
        document.getElementById('basicOffer').classList.add('selected');
        document.getElementById('limitedOffer').classList.remove('selected');
      }
    }

    /* 5-day countdown for Limited Time Offer */
    function startCountdown() {
      if(countdownInterval) clearInterval(countdownInterval);
      var target = new Date(limitedOfferExpiry).getTime();
      countdownInterval = setInterval(function(){
        var now = new Date().getTime();
        var distance = target - now;
        var days = Math.floor(distance / (1000 * 60 * 60 * 24));
        var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        var seconds = Math.floor((distance % (1000 * 60)) / 1000);
        document.getElementById('timer').innerText = days + "d " + hours + "h " + minutes + "m " + seconds + "s ";
        if(distance < 0) {
          clearInterval(countdownInterval);
          document.getElementById('timer').innerText = "Offer expired";
        }
      }, 1000);
    }

    /* "Select This Offer" CTA */
    function confirmOffer(type) {
      if(type === 'limited') {
        userSelections.offerSelected = 'limited';
        userSelections.notInterested = false;
        userSelections.cameFromAdjust = false;
        goToScreen('screen5');
      } else if(type === 'basic') {
        showModal('basic');
      }
    }

    /* "Adjust Offer" CTA */
    function showAdjustModal() {
      showModal('adjust');
    }

    /* "I am not interested" CTA */
    function showNotInterestedModal() {
      showModal('notInterested');
    }

    function showModal(context) {
      var modal = document.getElementById('confirmationModal');
      var title = document.getElementById('modalTitle');
      var msg = document.getElementById('modalMessage');
      var primaryBtn = document.getElementById('modalPrimaryBtn');
      var secondaryBtn = document.getElementById('modalSecondaryBtn');
      modal.style.display = 'flex';
      if(context === 'basic') {
        var amount = userSelections.loanAmount;
        var term = userSelections.loanTerm;
        var monthlyLimited = computeMonthlyInstallment(amount, term, 0.05, true, true);
        var monthlyBasic = computeMonthlyInstallment(amount, term, 0.065, userSelections.borrowerProtection, userSelections.extraCare);
        title.innerText = "Are you sure?";
        var diff = 0;
        if(monthlyBasic > monthlyLimited) {
          diff = (monthlyBasic - monthlyLimited).toFixed(2);
          msg.innerText = "The limited time offer is ₱" + formatNumber(diff) + " less than the basic offer and comes with Extra Care and Borrower's Protection!";
        } else {
          diff = (monthlyLimited - monthlyBasic).toFixed(2);
          msg.innerText = "Just add ₱" + formatNumber(diff) + " for the limited time offer that comes with Extra Care and Borrower's Protection already!";
        }
        primaryBtn.innerText = "I want the limited-time offer!";
        secondaryBtn.innerText = "Proceed with basic offer";
        primaryBtn.onclick = function() {
          modal.style.display = 'none';
          userSelections.offerSelected = 'limited';
          userSelections.notInterested = false;
          userSelections.cameFromAdjust = false;
          goToScreen('screen5');
        };
        secondaryBtn.onclick = function() {
          modal.style.display = 'none';
          userSelections.offerSelected = 'basic';
          userSelections.notInterested = false;
          userSelections.cameFromAdjust = false;
          goToScreen('screen5');
        };
      }
      else if(context === 'adjust') {
        title.innerText = "Are you sure?";
        msg.innerText = "You’ll miss out on interest savings with the limited time offer.";
        primaryBtn.innerText = "I want the limited-time offer!";
        secondaryBtn.innerText = "Proceed with adjust offer";
        primaryBtn.onclick = function() {
          modal.style.display = 'none';
          userSelections.offerSelected = 'limited';
          userSelections.notInterested = false;
          userSelections.cameFromAdjust = false;
          goToScreen('screen5');
        };
        secondaryBtn.onclick = function() {
          modal.style.display = 'none';
          userSelections.cameFromAdjust = true;
          goToScreen('screen4_3');
        };
      }
      else if(context === 'notInterested') {
        title.innerText = "Are you sure?";
        var expiryStr = limitedOfferExpiry.toDateString();
        msg.innerText = "This limited time offer is only available until " + expiryStr + ". Don’t miss out on this offer!";
        primaryBtn.innerText = "I want the limited-time offer!";
        secondaryBtn.innerText = "I am not interested at this time";
        primaryBtn.onclick = function() {
          modal.style.display = 'none';
          userSelections.offerSelected = 'limited';
          userSelections.notInterested = false;
          userSelections.cameFromAdjust = false;
          goToScreen('screen5');
        };
        secondaryBtn.onclick = function() {
          modal.style.display = 'none';
          userSelections.notInterested = true;
          userSelections.cameFromAdjust = false;
          goToScreen('screen5');
        };
      }
    }

    function updateFormSummary() {
      if(userSelections.notInterested) {
        document.getElementById('summaryAmount5').innerText = "";
        document.getElementById('summaryTerm5').innerText = "";
        document.getElementById('summaryMonthly5').innerText = "";
        return;
      }
      var amount = userSelections.loanAmount;
      var term = userSelections.loanTerm;
      var monthly = 0;
      if(userSelections.offerSelected === 'limited') {
        monthly = computeMonthlyInstallment(amount, term, 0.05, true, true);
      }
      else if(userSelections.offerSelected === 'basic') {
        monthly = computeMonthlyInstallment(amount, term, 0.065, userSelections.borrowerProtection, userSelections.extraCare);
      }
      else if(userSelections.offerSelected === 'adjust') {
        var adjAmount = userSelections.adjust.loanAmount || amount;
        var adjTerm = userSelections.adjust.loanTerm || term;
        var adjBP = userSelections.adjust.borrowerProtection;
        var adjEC = userSelections.adjust.extraCare;
        monthly = computeMonthlyInstallment(adjAmount, adjTerm, 0.06, adjBP, adjEC);
        amount = adjAmount;
        term = adjTerm;
      }
      document.getElementById('summaryAmount5').innerText = formatNumber(amount);
      document.getElementById('summaryTerm5').innerText = term;
      document.getElementById('summaryMonthly5').innerText = formatNumber(monthly.toFixed(2));
    }

    function formatNumber(num) {
      return parseInt(num).toLocaleString('en-US');
    }
  </script>
</body>
</html>
